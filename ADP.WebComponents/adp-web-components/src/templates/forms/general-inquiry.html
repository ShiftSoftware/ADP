<!doctype html>
<html lang="en" x-data="tradeIn()" x-init="init()">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>General Inquiry Form</title>

    <link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/npm/daisyui@5/themes.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>

    <script nomodule src="/build/shift-components.js"></script>
    <script type="module" src="/build/shift-components.esm.js"></script>

    <!-- Fonts: Noto Kufi Arabic + Nunito -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Kufi+Arabic:wght@100..900&family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet" />

    <!-- <link rel="stylesheet" href="https://tiq-standard-appstorage-byazfecba4bjd4cn.a02.azurefd.net/template-files/vehicle-quotation-tiq.css" /> -->
  </head>

  <body class="min-h-screen bg-base-200 flex flex-col items-center py-10 px-4 font-sans">
    <style>
      general-inquiry-form::part(general-inquiry-test) {
        margin: 32px 0px;
        user-select: none;
        font-family: 'Noto Kufi Arabic', 'Nunito', Roboto, Arial, sans-serif !important;
      }

      general-inquiry-form::part(container) {
        margin-left: auto;
        margin-right: auto;
        max-width: 700px;
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      general-inquiry-form::part(inputs_wrapper) {
        display: flex;
        flex-direction: column;
        gap: 24px;
        margin-bottom: 24px;
      }

      @media (min-width: 640px) {
        general-inquiry-form::part(inputs_wrapper) {
          display: grid;
          grid-template-columns: repeat(2, minmax(0, 1fr));
        }
      }
    </style>

    <!-- Floating setting -->
    <div class="fixed bottom-4 right-4 z-50 group">
      <button
        type="button"
        class="flex items-center justify-center w-11 h-11 rounded-full shadow-lg bg-white text-gray-600 border border-gray-200 group-hover:bg-indigo-500 group-hover:text-white transition-colors duration-200"
        x-text="isDev ? 'üß™' : 'üíª'"
      ></button>

      <div
        class="absolute bottom-10 pb-4 right-0 w-[min(90vw,420px)] opacity-0 scale-95 translate-y-2 pointer-events-none group-hover:opacity-100 group-hover:scale-100 group-hover:translate-y-0 group-hover:pointer-events-auto transition-all duration-200 origin-bottom-right"
      >
        <div class="bg-white border border-gray-200 rounded-2xl shadow-xl p-4 space-y-4">
          <div class="w-full flex flex-col sm:flex-row items-center justify-between gap-3 px-4 py-3 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100 rounded-xl">
            <h2 class="text-sm sm:text-base font-semibold text-gray-700 flex items-center gap-2">
              <span>üß≠</span> Mode:
              <span class="font-bold text-indigo-600" x-text="isDev ? 'Development' : 'Production'"></span>
            </h2>
            <label class="cursor-pointer flex items-center">
              <input type="checkbox" x-on:click="switchEnvironment" class="toggle toggle-primary ml-3" />
            </label>
          </div>

          <div class="flex flex-col items-center gap-3">
            <div class="text-center gap-3 flex items-center">
              <h2 class="text-sm sm:text-base font-semibold text-gray-700">üåê Language:</h2>
              <div class="flex flex-wrap justify-center gap-2">
                <template x-for="lang in languages" :key="lang">
                  <button class="btn btn-outline btn-xs sm:btn-sm" @click="updateLang(lang)" x-text="lang.toUpperCase()"></button>
                </template>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="w-full max-w-[800px] bg-base-100 shadow-xl rounded-2xl p-8">
      <div class="flex items-center justify-between mb-4">
        <a href="#" onclick="history.back()" class="btn btn-ghost text-blue-600 hover:bg-blue-50">‚Üê Back</a>
        <h1 class="text-3xl font-extrabold text-gray-800">General Inquiry Form</h1>
        <div class="w-[80px]"></div>
      </div>

      <general-inquiry-form
        theme="test"
        :is-dev="isDev"
        id="custom-component"
        disable-scroll-to-top="true"
        structure-url="https://adpstoragev2.blob.core.windows.net/tca-website/general-inquiry-form-structure.json?sv=2023-01-03&spr=https&st=2025-12-21T13%3A38%3A17Z&se=2999-12-22T13%3A38%3A00Z&sr=c&sp=rl&sig=pqiRRUA6hG83bVXVX6rBUtK24D2KkWsnztQ6RNk1fUc%3D"
      ></general-inquiry-form>

      <div class="mt-6 flex justify-center">
        <button type="button" class="btn btn-primary btn-lg" @click="submitForm" x-bind:disabled="!componentRef || !isFormReady">Submit Form (External Button)</button>
      </div>
    </div>

    <script>
      function tradeIn() {
        return {
          isDev: true,
          componentRef: null,
          isFormReady: false,
          languages: ['en', 'ku', 'ar', 'ru'],

          init() {
            this.componentRef = document.getElementById('custom-component');

            // Set the form ready callback
            if (this.componentRef) {
              this.componentRef.formReadyCallback = () => this.onFormReady();
            }

            // this.componentRef.fields = {
            //   name: {
            //     isDisabled: false,
            //     defaultValue: 'Test Form',
            //     // staticValue: 'Test Form',
            //   },
            //   phone: {
            //     // defaultValue: '+9647501111111',
            //     staticValue: '+9647501111111', // static value is auto disabled
            //   },
            //   vehicle: {
            //     isDisabled: true,
            //     defaultValue: '52739',
            //   },
            // };

            // this.componentRef.loadingChanges = this.loadingChanges;

            // this.componentRef.successCallback = this.successCallback;

            // this.componentRef.errorCallback = this.errorCallback;
          },

          updateLang(lang) {
            if (this.componentRef) {
              this.componentRef.language = lang;

              const url = new URL(window.location.href);

              url.searchParams.set('lang', lang);

              window.history.replaceState({}, '', url.toString());
            }
          },

          switchEnvironment() {
            this.isDev = !this.isDev;
          },

          onFormReady() {
            this.isFormReady = true;
          },

          submitForm() {
            if (this.componentRef && this.isFormReady) {
              this.componentRef.submit();
            }
          },

          //   loadingChanges(loading) {
          //     console.log('loading', loading);
          //   },

          //   successCallback(values) {
          //     console.log('success callback', values);
          //   },

          //   errorCallback(error) {
          //     console.log('error callback', error);
          //   },
        };
      }
    </script>
  </body>
</html>
